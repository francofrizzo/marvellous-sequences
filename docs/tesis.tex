\documentclass[11pt]{article}
\usepackage[a4paper, margin=2.25cm, headsep=1em]{geometry}

\usepackage[spanish]{babel}
\spanishlcroman
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[letterspace=25]{microtype}

\usepackage{amsmath,amssymb,amsthm}
\usepackage{bm}
\usepackage{cases}
\usepackage{xfrac}
\usepackage{color}
\usepackage{framed}
\usepackage{fancyhdr}

\usepackage{enumitem}
\setlist[enumerate,1]{label=(\alph*)}
\setlist[enumerate,2]{label=\roman*.}
\usepackage{float}
\usepackage[center]{caption}
\usepackage{cite}
\usepackage{diagbox}

\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{babel}

\newcommand\myauthor{Franco Frizzo}
\newcommand\mytitle{Tesis de licenciatura}
\newcommand\mydate{\today}

\usepackage[pdfauthor={\myauthor},
	    pdftitle={\mytitle},
	    hidelinks]{hyperref}

\setlength{\parskip}{.5em}
\renewcommand{\baselinestretch}{1.05}
\setlength{\headsep}{1.7em}
\setlist[enumerate]{itemsep=.1em, topsep=0em}
\setlist[itemize]{itemsep=.1em, topsep=0em}

\pagestyle{fancy}
\rhead{\MakeUppercase{\footnotesize{\textls{\myauthor}}}}
\lhead{\MakeUppercase{\footnotesize{\textls{\mytitle}}}}

\include{commands}

\begin{document}

\title{\mytitle}
\author{\myauthor}
\date{\mydate}

\maketitle
\tableofcontents

\newpage

\section{Introducción}

\section{Preliminares}

Para comenzar, presentamos algunas definiciones sobre secuencias que son
esenciales para comprender este trabajo, como así también algunos detalles
de la notación que utilizamos a lo largo del mismo.

Sea $\alphabet$ un alfabeto fijo de $b$ símbolos, con $b \geq 2$. En los
ejemplos que brindamos a lo largo de este trabajo consideramos el alfabeto
$\alphabet = \lbrace 0, 1 \rbrace$, a menos que se indique lo contrario.
Llamamos \emph{palabra} o \emph{cadena} a una secuencia finita de caracteres
tomados de este alfabeto.
Para referirnos a las posiciones que ocupan los caracteres dentro de una
palabra, las numeramos comenzando en $1$.

Definimos la función de rotación $\sigma: \alphabet^* \to \alphabet^*$ como
una transformación biyectiva que quita el último carácter de una palabra y lo
coloca al principio. Es decir,
\[ \sigma(\alpha_1\dots\alpha_{n-1}\alpha_n) =
	\alpha_n\alpha_1\dots\alpha_{n-1}. \]

La aplicación sucesiva de la función de rotación divide a las palabras en clases
de equivalencia, que llamamos \emph{collares}. Un collar es, entonces, el
conjunto de todas las rotaciones posibles de una palabra, y lo notamos usando
corchetes:
\[ \neck{w} = \lbrace \sigma^{n}(w) : n \in \nats_0 \rbrace. \]
Por ejemplo,
\[ \neck{11100} = \lbrace 11100, 01110, 00111, 10011, 11001 \rbrace; \]
\[ \neck{00000} = \lbrace 00000 \rbrace. \]
Un collar puede pensarse como una ``palabra circular'', donde no importa
cuál de los caracteres es el primero. A cada una de las palabras que forman
parte de un collar la llamamos un \emph{corte} del mismo.

El \emph{período} de una palabra $w$ es el menor $n > 0$ tal que
$\sigma^n(w) = w$. Por ejemplo, la cadena $11001100$ tiene período $4$,
mientras que $11001101$ tiene período $8$.
Notar que el período de una cadena necesariamente divide a su longitud.
Además, es igual a la cantidad de cortes distintos que posee el collar al que
pertenece la palabra.

Una \emph{subcadena} es una secuencia de caracteres consecutivos dentro de una
palabra. Usamos la notación $w\substr{i}{j}$ para hacer referencia a la
subcadena de $w$ que comprende las posiciones que van desde $i$ hasta $j$,
inclusive. En ocasiones, decimos que una palabra \emph{aparece} en otra palabra
para referirnos a que es una subcadena. Por ejemplo, $101$ y $1001$ aparecen en
(o son subcadenas de) la palabra $01010011$. Decimos que una palabra
\emph{aparece circularmente} en otra si aparece en alguna palabra del collar
correspondiente. Por ejemplo, $110$ no aparece en la palabra anterior, pero sí
aparece circularmente. En este caso, también podemos decir directamente que
la palabra \emph{aparece} en el collar.

\subsection{Collares y secuencias de De Bruijn}

En \cite{db}, Nicolaas G. de Bruijn realizó un detallado estudio de una clase
de collares que han pasado a ser conocidos con su nombre.

\begin{definition}[Collar de De Bruijn]
	Un \emph{collar de De Bruijn} de orden $n$ (o $n$-de De Bruijn) es un collar
	de longitud $b^n$ en el que cada una de las posibles palabras de longitud $n$ 
	aparece exactamente una vez.
\end{definition}

\begin{examples}
	El collar $\neck{11000101}$ es un collar de De Bruijn de orden $3$.
	El collar $\neck{0101100111101000}$ es un collar de De Bruijn de orden $4$.
\end{examples}

De Bruijn presenta una bonita caracterización de estos collares como circuitos
en una familia de digrafos que ha dado en conocerse como digrafos de De Bruijn.
El digrafo de De Bruijn de orden $n$ tiene como vértices todas las posibles
palabras de longitud $n$; existe una arista entre dos palabras si los últimos
$n-1$ caracteres de la primera coinciden con los primeros $n-1$ caracteres de la
segunda. Utilizamos la notación $G_n$ para referirnos al digrafo de De Bruijn
de orden $n$.

\begin{figure}[h] \centering
	\begin{tabular}{ccc}
		\begin{tabular}{c}
			\begin{tikzpicture}[->,>=stealth,auto,node distance=2cm,
				every loop/.style={},thick,main node/.style={circle,draw}]
			
			\node[main node] (0) {0};
			\node[main node] (1) [below of=0] {1};
			
			\draw[every node/.style={font=\scriptsize}]
			(0) edge [bend left] node {01} (1)
					edge [loop above] node {00} (0)
			(1) edge [bend left] node {10} (0)
					edge [loop below] node {11} (1);
			\end{tikzpicture}
		\end{tabular} &

		\begin{tabular}{c}
			\begin{tikzpicture}[->,>=stealth,auto,node distance=2.2cm,
				every loop/.style={},thick,main node/.style={circle,draw,font=\small}]
			
			\node[main node] (00) {00};
			\node[main node] (01) [below right of=00] {01};
			\node[main node] (10) [below left of=00] {10};
			\node[main node] (11) [below right of=10] {11};
			
			\draw[every node/.style={font=\scriptsize}]
			(00) edge [loop above] node {000} (00)
					edge [bend left] node {001} (01)
			(01) edge [bend left] node {011} (11)
					edge [bend left] node {010} (10)
			(10) edge [bend left] node {100} (00)
					edge [bend left] node {101} (01)
			(11) edge [bend left] node {110} (10)
					edge [loop below] node {111} (11);
			\end{tikzpicture}
		\end{tabular} &

		\begin{tabular}{c}
			\begin{tikzpicture}[->,>=stealth,auto,node distance=1.6cm,
				every loop/.style={},thick,main node/.style={circle,draw,font=\footnotesize}]
			
			\node[main node] (000) {000};
			\node[main node] (010) [below of=000] {010};
			\node[main node] (101) [below of=010] {101};
			\node[main node] (111) [below of=101] {111};
			
			\node[main node] (001) [right of=010,yshift=.35cm] {001};
			\node[main node] (100) [left of=010,yshift=.35cm] {100};
			\node[main node] (011) [right of=101,yshift=-.35cm] {011};
			\node[main node] (110) [left of=101,yshift=-.35cm] {110};
			
			\draw[every node/.style={font=\scriptsize}]
			(000) edge [loop above] node {0000} (000)
						edge [bend left=20] node {0001} (001)
			(001) edge [bend left=20] node {0010} (010)
						edge [bend left=25] node {0011} (011)
			(010) edge [bend left=20] node {0100} (100)
						edge [bend left] node {0101} (101)
			(011) edge [bend left=15] node {0110} (110)
						edge [bend left=20] node {0111} (111)
			(100) edge [bend left=20] node {1000} (000)
						edge [bend left=15] node {1001} (001)
			(101) edge [bend left] node {1010} (010)
						edge [bend left=20] node {1011} (011)
			(110) edge [bend left=25] node {1100} (100)
						edge [bend left=20] node {1101} (101)
			(111) edge [bend left=20] node {1110} (110)
						edge [loop below] node {1111} (111);
			\end{tikzpicture}
		\end{tabular} \\
		$G_1$ & $G_2$ & $G_3$
	\end{tabular}
	\caption{Digrafos de De Bruijn de orden $1$, $2$ y $3$ para un
		alfabeto de $2$ símbolos.}
\end{figure}

Cada collar de $n$-de De Bruijn se corresponde unívocamente con un circuito
hamiltoniano en el digrafo $G_n$, es decir, un camino cerrado que visita cada
vértice exactamente una vez. El collar se conforma concatenando en orden
el primer carácter de cada uno de los vértices visitados por el circuito.

Una propiedad muy interesante de la familia de digrafos de De Bruijn es que
cada $G_n$ es el grafo de línea de $G_{n-1}$; es decir, $G_n$ puede
construirse tomando como vértices el conjunto de aristas de $G_{n-1}$ y
colocando una arista entre cada par de vértices si las aristas correspondientes
en $G_{n-1}$ son adyacentes. Esto quiere decir que los circuitos hamiltonianos
en $G_n$ se corresponden con circuitos eulerianos en $G_{n-1}$, esto es,
caminos cerrados que utilizan cada arista exactamente una vez.

De Bruijn utiliza esta naturaleza recursiva de la familia de digrafos $G_n$
para demostrar una fórmula cerrada para la cantidad de collares de De Bruijn
de orden $n$ existentes, que es exactamente $\frac{b^{b^{n-1}}}{b^n}$.

Cabe señalar que, debido a sus características, la forma más natural de
presentar la definición de los collares de De Bruijn es justamente en términos
de collares, o palabras circulares. No obstante --y esta situación se repite
para otras definiciones similares que aparecen más adelante en este trabajo--,
en ocasiones interesa tener en cuenta cada corte particular de un collar como
un elemento distinto. Por eso, en adelante, utilizaremos el término
\emph{secuencia de De Bruijn} para referirnos a un corte de un collar de De
Bruijn\footnote{Queremos hacer énfasis en este punto, ya que el término
\emph{secuencia de De Bruijn} es utilizado de forma ambigua en la literatura.
Para algunos autores, una secuencia de De Bruijn de orden $n$ es una secuencia
de longitud $b^n + n - 1$, donde cada palabra posible de longitud $n$ aparece
exactamente una vez, sin considerar apariciones circulares.}.

¿Cuántas secuencias $n$-de De Bruijn existen para cada $n$? Se puede notar que
el período de una secuencia $n$-de De Bruijn es necesariamente igual a su
longitud, $b^n$; de lo contrario, la palabra de longitud $n$ con la que comienza
volvería a aparecer más adelante. Luego, cada collar $n$-de De Bruijn tiene
$b^n$ cortes distintos, con lo cual la cantidad de secuencias $n$-de De Bruijn
es exactamente $b^{b^{n-1}}$.

\subsection{El teorema BEST}

El teorema BEST es un resultado en teoría de grafos que permite determinar la
cantidad de circuitos eulerianos en un digrafo. Recibe su nombre por las
iniciales de sus descubridores, de Bruijn, van Aardenne-Ehrenfest, Smith y
Tutte.

\begin{lemma*}[BEST, \pending{citar}]
	Sea $G$ un multidigrafo euleriano con vértices $v_1, \dots, v_n$.
	La cantidad de circuitos eulerianos en $G$ está dada por
	\[ \epsilon(G) = c \cdot \prod_{i=1}^n (d_i - 1)!, \]
	donde $d_i$ es el grado de salida de $v_i$ y $c$ es la cantidad de árboles
	generadores de $G$ orientados hacia un vértice arbitrario.
\end{lemma*}

Recordemos que un multidigrafo euleriano es aquel en el que existe algún circuito
euleriano, o equivalentemente, aquel en que los grados de entrada y de
salida coinciden para todos los vértices.

\pending{Enunciar cómo se aplica para grafos de De Bruijn. ¿Definir laplaciano
o solo citar cantidad de árboles generadores?}

\subsection{Secuencias maravillosas}

A continuación presentaremos una generalización de las secuencias de De Bruijn,
que denominaremos \emph{secuencias maravillosas}.

\begin{definition}[Secuencia maravillosa]
Un \emph{collar $(n,m)$-maravilloso} es una collar de longitud $m \cdot b^n$
en el que cada una de las posibles palabras de longitud $n$ aparece
exactamente $m$ veces.

Una \emph{secuencia $(n,m)$-maravillosa} es un corte de un collar
$(n,m)$-maravilloso.
\end{definition}

\begin{examples}
	Las siguientes secuencias son $(2,4)$ y $(3,3)$-maravillosas, respectivamente:
	\[ 1110000111010010; \qquad 000111110110110100100100. \]

	Todas las secuencias $n$-de De Bruijn son ejemplos de secuencias
	$(n,1)$-maravillosas.
\end{examples}

Una pregunta inmediata que surge de esta definición es cómo puede extenderse a
los collares maravillosos la caracterización como circuitos eulerianos
presentada para los collares de De Bruijn, y si es posible utilizar este enfoque
para determinar la cantidad de secuencias maravillosas existentes para cada valor
de $n$ y $m$, lo cual resulta de especial interés más adelante en este
trabajo.

Un enfoque posible consiste en definir una familia de \emph{multidigrafos de De
	Bruijn}.
Llamamos multidigrafo de De Bruijn de orden $n$ y grado $m$ al multidigrafo
$G_n^m$ que se obtiene a partir del digrafo de De Bruijn de orden $n$ si se
replica $m$ veces cada arista.
Con esta definición, es inmediato comprobar que todo circuito euleriano en
$G_n^m$ (o hamiltoniano en $G_{n+1}^m$) determina de manera unívoca un collar
$(n+1, m)$-maravilloso.
Recordemos que cada arista de $G_n$ puede asociarse con una palabra distinta de
longitud $n+1$; como en $G_n^m$ existen $m$ copias de cada arista, una
secuencia obtenida a partir de un circuito euleriano contendrá cada una de
estas palabras exactamente $m$ veces.


\begin{figure}[h] \centering
	\begin{tikzpicture}[->,>=stealth,auto,node distance=2.2cm,
		every loop/.style={},thick,main node/.style={circle,draw,font=\small}]
	
	\node[main node] (00) {00};
	\node[main node] (01) [below right of=00] {01};
	\node[main node] (10) [below left of=00] {10};
	\node[main node] (11) [below right of=10] {11};
	
	\draw[every node/.style={font=\scriptsize}]
	(00) edge [in=30, out=60, loop] (00)
	     edge [loop above] node {000} (00)
	     edge [in=120, out=150, loop] (00)
	     edge [bend left=36] node {001} (01)
	     edge [bend left=23] (01)
	     edge [bend left=10] (01)
	(01) edge [bend left=36] node {011} (11)
	     edge [bend left=23] (11)
	     edge [bend left=10] (11)
	     edge [bend left=36] node {010} (10)
	     edge [bend left=23] (10)
	     edge [bend left=10] (10)
	(10) edge [bend left=36] node {100} (00)
	     edge [bend left=23] (00)
	     edge [bend left=10] (00)
	     edge [bend left=36] node {101} (01)
	     edge [bend left=23] (01)
	     edge [bend left=10] (01)
	(11) edge [bend left=36] node {110} (10)
	     edge [bend left=23] (10)
	     edge [bend left=10] (10)
	     edge [in=210, out=240, loop] (11)
	     edge [loop below] node {111} (11)
	     edge [in=300, out=330, loop] (11);
	\end{tikzpicture}
	\caption{Multidigrafo de De Bruijn de orden $2$ y grado $3$
		para un alfabeto de $2$ símbolos.}
\end{figure}


No obstante, esto no vale a la inversa, ya que si $m > 1$, todo collar
$(n+1,m)$-maravilloso se corresponde con más de un ciclo euleriano en $G_n^m$.
Esto se debe a que las $m$ apariciones de una palabra de longitud $n + 1$ en un
collar son indistinguibles, por lo que las $m$ aristas respectivas pueden ser
permutadas, obteniendo un nuevo ciclo euleriano que se corresponde con el mismo
collar.
Concretamente, como existen $m! $ maneras de permutar cada conjunto de $m$
aristas, se tiene un total de $b^{n+1} \cdot m!$ maneras distintas de
representar un collar $(n+1,m)$-maravilloso con un circuito euleriano.

Si se tiene este hecho en consideración, es posible aplicar el teorema BEST
para contabilizar la cantidad de circuitos eulerianos en los multidigrafos de
De Bruijn y así obtener una fórmula cerrada para la cantidad de collares
maravillosos.
Sin embargo, si lo que se desea contar son las secuencias maravillosas --en
lugar de los collares--, surge una nueva dificultad, ya que a diferencia de los
collares de De Bruijn, el período de un collar maravilloso no es invariante, es
decir, la cantidad de secuencias distintas que pueden obtenerse realizando
cortes a un collar maravilloso es diferente para cada collar.

Para salvar este obstáculo, decidimos buscar un enfoque alternativo que
permitiera caracterizar directamente las secuencias maravillosas, utilizando la
noción de \emph{circuito $\pi$-euleriano} presentada por Farrell y Levine en
\cite{Farrell_Levine_2016}.

\begin{definition}[Circuito $\pi$-euleriano, \cite{Farrell_Levine_2016}]
	Sea $G$ un digrafo con vértices $v_1, \dots, v_n$, y sea $\pi \in
		\mathbb{N}^n$
	un vector con valores estrictamente positivos.
	Un circuito $\pi$-euleriano en $G$ es un circuito donde cada arista
	($v_i$, $v_j$) se utiliza exactamente $\pi_j$ veces.
\end{definition}

Esta noción generaliza la de circuito euleriano, ya que estos son circuitos
$\pi$-eulerianos con $\pi = (1, \dots, 1)$.
Partiendo de aquí, los autores presentan la siguiente generalización del
teorema BEST.

\begin{lemma*}[BEST generalizado, \cite{Farrell_Levine_2016}]
	\label{prop:BEST-generalized}
	Sea $G$ un multidigrafo fuertemente conexo con vértices $v_1, \dots, v_n$, y
	sea $\pi \in \mathbb{N}^n$.
	Existen un circuito $\pi$-euleriano en $G$ si y solo si
	\[ \laplacian(G) \cdot \pi = 0, \]
	en cuyo caso la cantidad de estos circuitos que comienzan con una arista $e$
	determinada es
	\[ \epsilon_\pi(G, e) = c_e \cdot
		\prod_{i=1}^n \frac{(d_i\pi_i - 1)! }{(\pi_i!)^{d_i-1}(\pi_i-1)!}, \]
	donde $d_i$ es el grado de salida de $v_i$, y $c_e$ es la cantidad de árboles
	generadores de $G$ orientados hacia la cola de $e$.
\end{lemma*}

El interés de esta definición para nuestro problema particular radica en que
una secuencia $(n+1,m)$-maravillosa puede identificarse de forma unívoca con un
circuito $\pi$-euleriano en $G_n$ tomando $\pi = (m,\dots,m)$ y fijando cuál
será su arista inicial.
Esto nos permite enunciar y demostrar el siguiente resultado.

\begin{theorem}
	\label{theorem:marvellous-count}
	Sean $n, m > 0$.
	La cantidad de secuencias $(n,m)$-maravillosas es exactamente
	$\left( \frac{(bm)! }{(m!)^b} \right)^{b^{n-1}}$.
\end{theorem}

\begin{proof}
	Consideraremos primero el caso en que $n > 1$.
	En este caso, como se mencionó anteriormente, fijando $\pi = (m, \dots, m)$,
	basta con determinar la cantidad de circuitos $\pi$-eulerianos en $G_{n-1}$
	para cada una de las posibles elecciones de arista inicial.
	Es decir que, en virtud del Lema \ref{prop:BEST-generalized}, la cantidad de
	secuencias maravillosas será igual a \[ \sum_e \epsilon_\pi(G_{n-1}, e) =
		\sum_e c_e \cdot \prod_{i=1}^{b^{n-1}} \frac{(d_i\pi_i - 1)!
		}{(\pi_i!)^{d_i-1}(\pi_i-1)!}, \] donde la suma se realiza sobre todas las
	aristas del digrafo $G_{n-1}$.

	Se sabe que la cantidad de aristas de $G_{n-1}$ es $b^n$; por otro lado, la
	cantidad de árboles generadores orientados hacia cualquiera de los nodos de
	$G_{n-1}$ es $\frac{b^{b^{n-1}}}{b^n}$ [¿cita?], de donde se sigue que
	$\sum_{e} c_e = b^{b^{n-1}}$.
	Reemplazando en la expresión anterior, se obtiene \[ b^{b^{n-1}} \cdot
		\prod_{i=1}^{b^{n-1}} \frac{(d_i\pi_i - 1)! }{(\pi_i!)^{d_i-1}(\pi_i-1)!}.
	\]

	Dado que $G_{n-1}$ es un digrafo regular cuyos vértices tienen todos grado de
	salida $b$, y dado que $\pi_i = m$ para todo $i = 1, \dots, b^{n-1}$, la
	expresión anterior equivale a
	\begin{align*}
		b^{b^{n-1}} \cdot \left( \frac{(bm - 1)! }{(m!)^{b-1}(m-1)!} \right)^{b^{n-1}}
			&= \left( \frac{b (bm - 1)! }{(m!)^{b-1}(m-1)!} \right)^{b^{n-1}} \\
			&= \left( \frac{bm (bm - 1)! }{(m!)^{b-1}m(m-1)!} \right)^{b^{n-1}} \\
			&= \left( \frac{(bm)! }{(m!)^b} \right)^{b^{n-1}}.
	\end{align*}

	Resta demostrar el caso en que $n = 1$. Para esto, basta observar que una
	secuencia $(1,m)$-maravillosa es una secuencia de longitud $bm$ en donde
	cada uno de los $b$ símbolos del alfabeto aparece exactamente $m$ veces.
	Por lo tanto, para construir una de estas secuencias, en primer lugar es
	necesario seleccionar cuáles $m$ de entre las $bm$ posiciones corresponderán
	al primer símbolo; luego, cuáles $m$ de entre las $(b - 1)m$ posiciones
	restantes corresponderán al segundo símbolo; en tercer lugar, cuáles $m$ de
	entre las $(b - 2)m$ posiciones restantes corresponderán al tercer símbolo,
	y así sucesivamente. Es decir, la cantidad de formas distintas de construir
	una secuencia $(1,m)$-maravillosa puede expresarse como el siguiente producto
	de números combinatorios:
	\begin{align*}
		\prod_{i = 0}^{b - 1} \binom{(b - i)m}{m}
			&= \prod_{i = 0}^{b - 1} \frac{((b-i)m)!}{m!((b-i-1)m)!} \\
			&= \frac{(bm)!}{m!((b-1)m)!} \cdot
				\frac{((b-1)m)!}{m!((b-2)m)!} \cdot
				\frac{((b-2)m)!}{m!((b-3)m)!} \cdot \dots \cdot
				\frac{m!}{m!0!} \\
			&= \frac{(bm)!}{(m!)^b},
		\end{align*}
	lo cual es consistente con la fórmula presentada.
\end{proof}

\subsection{Secuencias maravillosas anidadas}

\pending{Definir secuencia maravillosa anidada.}

\pending{Definir secuencia perfecta anidada.}

\pending{Definir $m$-átomo.}

\section{Métodos de construcción}

\subsection{Secuencias autosimilares}

En este apartado, presentaremos un método de construcción que permite generar
secuencias $(n,m)$-maravillosas anidadas que no son perfectas anidadas, siempre
y cuando se cumpla que $m = b^{n - 1}$.
Este método fue motivado por el estudio de una subfamilia de las secuencias
maravillosas anidadas, que denominamos \emph{secuencias autosimilares}.

\begin{definition}
	Una secuencia $x$ es $(n,m)$-\emph{autosimilar} si consiste en $b^{n-1}$
	repeticiones de una misma secuencia de longitud $bm$.
\end{definition}

\begin{example}
	La secuencia \[ 01110110\ 01110110\ 01110110\ 01110110 \] es
	$(3,4)$-autosimilar.
	La secuencia \[ 110000101011 \ 110000101011 \] es $(2,6)$-autosimilar; además,
	es $(2,6)$-maravillosa anidada.
\end{example}

\begin{proposition} \label{proposition:autosimilar-cannot-be-np}
	Una secuencia $(n,m)$-autosimilar con $n > 1$ no puede ser $(n,m)$-perfecta.
\end{proposition}

\begin{proof}
	Dado que la secuencia se construye repitiendo al menos dos veces una misma
	secuencia de longitud $bm$, la palabra de longitud $n$ que aparece en la
	posición $0$ de la secuencia aparece nuevamente en la posición $bm$.
	Esto contradice la definición de secuencia perfecta, ya que cada aparición de
	dicha palabra debería comenzar en una posición distinta módulo $m$.
\end{proof}

Nos interesa estudiar las secuencias $(n,m)$-maravillosas anidadas que, además,
son autosimilares.
Cabe señalar que las mismas están conformadas por un único $m$-átomo repetido
$b^{n-1}$ veces.
La proposición que enunciaremos a continuación nos permite caracterizarlas a
partir de una propiedad verificable los átomos que les dan origen.
Este resultado nos permitirá determinar para qué valores de $(n,m)$ existen
este tipo de secuencias, cuál es su cantidad, y presentar un método para su
construcción.

\begin{theorem}
	\label{theorem:autosimilar-nm-characterization}
	Sea $x = \omega^{b^{n-1}}$ una secuencia $(n,m)$-autosimilar.
	$x$ es $(n,m)$-maravillosa anidada si y solo si $b^{n-1} \vert m$ y
	$\omega$
	es una secuencia $\left( n, \frac{m}{b^{n-1}} \right)$-maravillosa.
\end{theorem}

\begin{examples}\ %
	\begin{itemize}
		\item El $4$-átomo $01011100$ es $(1,4)$, $(2,2)$ y
		      $(3,1)$-maravilloso.
		      Por lo tanto, las siguientes tres secuencias son $(1,4)$, $(2,4)$ y
		      $(3,4)$-maravillosas anidadas, respectivamente.
		      \[ 01011100; \qquad 01011100\ 01011100; \qquad 01011100\
			      01011100\ 01011100\ 01011100.
		      \]
		\item El $4$-átomo $10001101$ es $(1,4)$ y $(2,2)$-maravilloso,
		      pero no $(3,1)$-maravilloso.
		      Por lo tanto, las siguientes dos secuencias son $(3,1)$ y $(3,2)$-maravillosas
		      anidadas, respectivamente.
		      \[ 10001101; \qquad 10001101\ 10001101,
		      \]
		      pero la secuencia
		      \[ 10001101\ 10001101\ 10001101\
			      10001101 \]
		      no es $(3,4)$-maravillosa anidada.
	\end{itemize}
\end{examples}

El siguiente lema se presentan a modo de resultado intermedio para
demostrar el Teorema \ref{theorem:autosimilar-nm-characterization}.

\begin{lemma} \label{lemma:marvellous-for-smaller-n}
	Sea $x$ una secuencia $(n,m)$-mavarillosa.
	Para todo $k$ tal que $0 \leq k < n$, la secuencia $x$ es
	$(n - k, b^{k}m)$-maravillosa.
\end{lemma}

\begin{example}
	La secuencia $(3,4)$-maravillosa \[ 00001111\ 00101011\ 00101101\ 11100010, \]
	es también $(2,8)$ y $(1,16)$-maravillosa.
\end{example}

\begin{proof}
	Consideremos una palabra $w$ cualquiera de longitud $n - k$.
	Para extender $w$ a una palabra de longitud $n$ debe agregársele un sufijo de
	longitud $k$, por lo que existen $b^{k}$ formas distintas de hacerlo.
	Todas estas palabras que resultan de extender $w$ aparecen exactamente $m$
	veces en $x$, ya que esta es una secuencia $(n,m)$-mavarillosa.
	Luego, $w$ aparece exactamente $b^{k}m$ veces en $x$, $m$ veces como prefijo de
	una palabra de longitud $n$ distinto.
	Por lo tanto, $x$ es una secuencia $(n - k, b^{k}m)$-maravillosa.
\end{proof}

Habiendo probado este resultado, estamos en condiciones de presentar una
demostración para el Teorema \ref{theorem:autosimilar-nm-characterization}.

\begin{proof}[Demostración del Teorema \ref{theorem:autosimilar-nm-characterization}]
	Si partimos del supuesto de que $b^{n-1}$ no divide a $m$, o bien que
	$\omega$ no es una secuencia $\left( n, \frac{m}{b^{n-1}}
		\right)$-maravillosa,
	podemos concluir que existe una palabra $w$ de longitud $n$ que aparece
	circularmente en $\omega$ una cantidad de veces diferente de
	$\frac{m}{b^{n-1}}$.
	Por lo tanto, la cantidad de veces que $w$ aparece circularmente
	en $x = \omega^{b^{n-1}}$ es diferente de $m$.
	Es decir, en este caso, $x$ no puede ser una secuencia $(n,m)$-maravillosa
	anidada.

	Para demostrar la implicación opuesta, supongamos que $b^{n-1} \vert m$
	y $\omega$ es una secuencia $\left(n, \frac{m}{b^{n-1}} \right)$-maravillosa.
	Demostraremos que para todo $n'$ tal que $1 \leq n' \leq n$, la secuencia
	$\omega^{b^{n'-1}}$ es $(n',m)$-maravillosa anidada.
	En el caso particular $n' = n$, esto equivale a decir que $x$ es una secuencia
	$(n,m)$-maravillosa anidada.

	En el caso $n' = 1$, el resultado se sigue del Lema
	\ref{lemma:marvellous-for-smaller-n} que, tomando $k = n-1$, nos permite
	afirmar que $\omega$ es una secuencia $(1,m)$-maravillosa.

	Si $n'$ es tal que $1 < n' \leq n$, supongamos probado el resultado para
	$n'-1$.
	Esto quiere decir que, siendo $y = \omega^{b^{n' - 2}}$, $y$ es una secuencia
	$(n'-1, m)$-maravillosa anidada.
	Para probar que $\omega^{b^{n' - 1}} = yy$ es $(n',m)$-maravillosa anidada,
	solo resta ver que es $(n',m)$-maravillosa, ya que es la concatenación de dos
	secuencias $(n'-1, m)$-maravillosas anidadas.

	Empleando otra vez el Lema \ref{lemma:marvellous-for-smaller-n}, esta vez para
	$k = n - n'$, tenemos que $\omega$ es una secuencia $\left( n', \frac{m}{b^{n'
				- 1}} \right)$-maravillosa.
	Esto significa que la cantidad de apariciones de cada palabra de longitud $n'$
	en $\omega$, mirada circularmente, es $\frac{m}{b^{n' - 1}}$; y por
	consiguiente, es $m$ en $\omega^{b^{n'-1}}$, por lo que esta última secuencia
	es $(n',m)$-maravillosa anidada.
\end{proof}

Dado que conocemos la cantidad de secuencias maravillosas que existen para
cualesquiera valores de $n$ y $m$, podemos enunciar el siguiente corolario.

\begin{corollary} \label{corollary:autosimilar-nm-count}
	Sean $n, m > 0$.
	Si $b^{n-1} \vert m$, sea $k = \frac{m}{b^{n-1}}$; existen
	$\left( \frac{(bk)! }{(k!)^b} \right)^{b^{n-1}}$
	secuencias $(n,m)$-maravillosas anidadas que son autosimilares.
	De lo contrario, no existe ninguna tal secuencia.
\end{corollary}

\begin{proof}
	Se sigue de forma inmediata de la caracterización dada por el Teorema
	\ref{theorem:autosimilar-nm-characterization} y la fórmula para la cantidad de
	secuencias maravillosas presentada en el Teorema \ref{theorem:marvellous-count}.
\end{proof}

La siguientes tabla muestra las cantidades de secuencias maravillosas anidadas
autosimilares para los primeros valores de $n$ y $m$, considerando alfabetos
de $2$ y de $3$ símbolos.

\begin{table}[H]
	\centering
	\begin{tabular}{ c | c | c | c | c | c | c | c | c | c }
		\diagbox{$n$}{$m$}	& 1 & 2 & 3  & 4  & 5   & 6   & 7    & 8     & 9     \\
		\hline
		1 & 2 & 6 & 20 & 70 & 252 & 924 & 3.432 & 12.870 & 48.620
		\\ \hline
		2 & 0 & 4 & 0  & 36 & 0   & 400 & 0     & 4.900  & 0     \\
		\hline
		3 & 0 & 0 & 0  & 16 & 0   & 0   & 0     & 1.296  & 0     \\
		\hline
		4 & 0 & 0 & 0  & 0  & 0   & 0   & 0     & 256    & 0     \\
		\hline
		5 & 0 & 0 & 0  & 0  & 0   & 0   & 0     & 0      & 0
	\end{tabular}
	\caption{Cantidad de secuencias $(n,m)$-maravillosas anidadas autosimilares
		considerando un alfabeto de $2$ símbolos.}
\end{table}

\begin{table}[H]
	\centering
	\begin{tabular}{ c | c | c | c | c | c | c | c | c | c }
		\diagbox[width=3em]{$n$}{$m$} & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 \\ \hline
		1 & 6 & 90 & 1.680 & 34.650 & 756.756 & 17.153.136 & 399.072.960 & 9.465.511.770 & 227.873.431.500 \\ \hline
		2 & 0 & 0  & 216   & 0      & 0       & 729.000    & 0           & 0             & 4.741.632.000 \\ \hline
		3 & 0 & 0  & 0     & 0      & 0       & 0          & 0           & 0             & 10.077.696    \\ \hline
		4 & 0 & 0  & 0     & 0      & 0       & 0          & 0           & 0             & 0
	\end{tabular}
	\caption{Cantidad de secuencias $(n,m)$-maravillosas anidadas autosimilares
		considerando un alfabeto de $3$ símbolos.}
\end{table}

Puede notarse que, debido a la condición de que $b^{n-1} \vert m$ necesaria
para la existencia de este tipo de secuencias, el menor $m$ para el cual la
cantidad de secuencias no es $0$ dado un $n$ fijo es $m = b^{n-1}$. Este caso
es especialmente interesante ya que los átomos que se utilizarán son secuencias
$(n, 1)$-maravillosas, es decir, secuencias $n$-de De Bruijn.

\note{Creo que acá se podría hacer referencia a métodos existentes para
construir secuencias de De Bruijn y como este método permite adaptarlos
de una forma muy simple para obtener secuencias maravillosas anidadas.}

\bibliography{references}{}
\bibliographystyle{plain}

\end{document}
