\documentclass[11pt]{article}
\usepackage[a4paper, margin=2.25cm, headsep=1em]{geometry}

\usepackage[spanish]{babel}
\spanishlcroman
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[letterspace=25]{microtype}

\usepackage{amsmath,amssymb,amsthm}
\usepackage{bm}
\usepackage{cases}
\usepackage{xfrac}
\usepackage{color}
\usepackage{framed}
\usepackage{fancyhdr}

\usepackage{enumitem}
\setlist[enumerate,1]{label=(\alph*)}
\setlist[enumerate,2]{label=\roman*.}
\usepackage{float}
\usepackage[center]{caption}
\usepackage{cite}
\usepackage{diagbox}

\newcommand\myauthor{Franco Frizzo}
\newcommand\mytitle{Tesis de licenciatura}
\newcommand\mydate{\today}

\usepackage[pdfauthor={\myauthor},
	    pdftitle={\mytitle},
	    hidelinks]{hyperref}

\setlength{\parskip}{.5em}
\renewcommand{\baselinestretch}{1.05}
\setlength{\headsep}{1.7em}
\setlist[enumerate]{itemsep=.1em, topsep=0em}
\setlist[itemize]{itemsep=.1em, topsep=0em}

\pagestyle{fancy}
\rhead{\MakeUppercase{\footnotesize{\textls{\myauthor}}}}
\lhead{\MakeUppercase{\footnotesize{\textls{\mytitle}}}}

\include{commands}

\begin{document}

\title{\mytitle}
\author{\myauthor}
\date{\mydate}

\maketitle
\tableofcontents

\section{Introducción}

\section{Preliminares}

\pending{Definir secuencias de De Bruijn.}

\pending{Mostrar representación como grafos de De Bruijn y dar conteo.}

\pending{Enunciar teorema BEST. ¿Con qué nivel de detalle? Definir laplaciano.}

\subsection{Secuencias maravillosas}

A continuación presentaremos una generalización de las secuencias de De Bruijn,
que denominaremos \emph{secuencias maravillosas}.

Decimos que una secuencia es $(n,m)$-maravillosa si cada una de las $2^n$
palabras de longitud $n$ aparece exactamente $m$ veces en la secuencia, mirada
circularmente.

\begin{examples}
	Las siguientes secuencias son $(2,4)$ y $(3,3)$-maravillosas, respectivamente:
	\[ 1110000111010010; \qquad 000111110110110100100100.
	\]

	Todos los cortes de collares $n$-de De Bruijn son ejemplos de secuencias
	$(n,1)$-maravillosas.
\end{examples}

Llamaremos collar $(n,m)$-maravilloso a cada una de las clases de equivalencia
de las secuencias $(n,m)$-maravillosas bajo la operación de rotación.

Una pregunta inmediata que surge de esta definición es cómo puede extenderse a
las secuencias maravillosas la caracterización como circuitos eulerianos
presentada por De Bruijn en \cite{db} para los collares que llevan su nombre, y
si es posible utilizar este enfoque para determinar la cantidad de secuencias
maravillosas existentes para cada valor de $n$ y $m$, lo cual resultará de
especial interés más adelante en este trabajo.

Un enfoque posible consiste en definir una familia de \emph{multidigrafos de De
	Bruijn}.
Llamamos multidigrafo de De Bruijn de orden $n$ y grado $m$ al multidigrafo
$G_n^m$ que se obtiene a partir del digrafo de De Bruijn de orden $n$ si se
replica $m$ veces cada arista.
Con esta definición, es inmediato comprobar que todo circuito euleriano en
$G_n^m$ determina de manera unívoca un collar $(n+1, m)$-maravilloso:
recordemos que cada arista de $G_n$ puede asociarse con una palabra distinta de
longitud $n+1$; como en $G_n^m$ existen $m$ copias de cada arista, una
secuencia obtenida a partir de un circuito euleriano contendrá cada una de
estas palabras exactamente $m$ veces.

No obstante, esto no vale a la inversa, ya que si $m > 1$, todo collar
$(n+1,m)$-maravilloso se corresponde con más de un ciclo euleriano en $G_n^m$.
Esto se debe a que las $m$ apariciones de una palabra de longitud $n + 1$ en un
collar son indistinguibles, por lo que las $m$ aristas respectivas pueden ser
permutadas, obteniendo un nuevo ciclo euleriano que se corresponde con el mismo
collar.
Concretamente, como existen $m! $ maneras de permutar cada conjunto de $m$
aristas, se tiene un total de $2^{n+1} \cdot m!$ maneras distintas de
representar un collar $(n+1,m)$-maravilloso con un circuito euleriano.

Si se tiene este hecho en consideración, es posible aplicar el teorema BEST
para contabilizar la cantidad de circuitos eulerianos en los multidigrafos de
De Bruijn y así obtener una fórmula cerrada para la cantidad de collares
maravillosos.
Sin embargo, si lo que se desea contar son las secuencias maravillosas --en
lugar de los collares--, surge una nueva dificultad, ya que a diferencia de los
collares de De Bruijn, el período de un collar maravilloso no es invariante, es
decir, la cantidad de secuencias distintas que pueden obtenerse realizando
cortes a un collar maravilloso es diferente para cada collar.

Para salvar este obstáculo, decidimos buscar un enfoque alternativo que
permitiera caracterizar directamente las secuencias maravillosas, utilizando la
noción de \emph{circuito $\pi$-euleriano} presentada por Farrell y Levine en
\cite{Farrell_Levine_2016}.

\begin{definition}[\cite{Farrell_Levine_2016}]
	Sea $G$ un digrafo con vértices $v_1, \dots, v_n$, y sea $\pi \in
		\mathbb{N}^n$
	un vector con valores estrictamente positivos.
	Un circuito $\pi$-euleriano en $G$ es un circuito donde cada arista
	($v_i$, $v_j$) se utiliza exactamente $\pi_j$ veces.
\end{definition}

Esta noción generaliza la de circuito euleriano, ya que estos son circuitos
$\pi$-eulerianos con $\pi = (1, \dots, 1)$.
Partiendo de aquí, los autores presentan la siguiente generalización del
teorema BEST.

\begin{lema}[Teorema BEST generalizado, \cite{Farrell_Levine_2016}]
	\label{prop:BEST-generalized}
	Sea $G$ un multidigrafo fuertemente conexo con vértices $v_1, \dots, v_n$, y
	sea $\pi \in \mathbb{N}^n$.
	Existen un circuito $\pi$-euleriano en $G$ si y solo si \[ \laplacian(G) \cdot
		\pi = 0, \] en cuyo caso la cantidad de estos circuitos que comienzan con una
	arista $e$ determinada es \[ \epsilon_\pi(G, e) = c_e \cdot \prod_{i=1}^n
		\frac{(d_i\pi_i - 1)! }{(\pi_i!)^{d_i-1}(\pi_i-1)!}, \] donde $c_e$ es la
	cantidad de árboles generadores de $G$ orientados hacia la cola de $e$, y $d_i$
	es el grado de salida de $v_i$.
\end{lema}

\note{El laplaciano ahí molesta un poco. La condición $\laplacian(G) \cdot
\pi = 0$ está puesta como una forma de generalizar que el grafo sea euleriano.
En el caso para el que lo vamos a usar nosotros el grafo es euleriano, por lo
cual la condición va a ser verdadera, pero en rigor para usar el teorema
habría que mostrar que eso vale. No me quedó del todo claro cómo escribirlo
sin enredarme mucho, igual habría que ver cuánto voy a hablar previamente
del laplaciano y de cómo se calculan los cofactores para un grafo de De Bruijn.}

El interés de esta definición para nuestro problema particular radica en que
una secuencia $(n+1,m)$-maravillosa puede identificarse de forma unívoca con un
circuito $\pi$-euleriano en $G_n$ tomando $\pi = (m,\dots,m)$ y fijando cuál
será su arista inicial.
Esto nos permite enunciar y demostrar el siguiente resultado.

\begin{theorem}
	\label{theorem:marvellous-count}
	Sea $n, m > 0$.
	La cantidad de secuencias $(n,m)$-maravillosas es exactamente $\binom{2m}{m}^{2^{n-1}}$.
\end{theorem}

\begin{proof}
	Consideraremos primero el caso en que $n > 1$.
	En este caso, como se mencionó anteriormente, fijando $\pi = (m, \dots, m)$,
	basta con determinar la cantidad de circuitos $\pi$-eulerianos en $G_{n-1}$
	para cada una de las posibles elecciones de arista inicial.
	Es decir que, en virtud del Lema \ref{prop:BEST-generalized}, la cantidad de
	secuencias maravillosas será igual a \[ \sum_e \epsilon_\pi(G_{n-1}, e) =
		\sum_e c_e \cdot \prod_{i=1}^{2^{n-1}} \frac{(d_i\pi_i - 1)!
		}{(\pi_i!)^{d_i-1}(\pi_i-1)!}, \] donde la suma se realiza sobre todas las
	aristas del digrafo $G_{n-1}$.

	Se sabe que la cantidad de aristas de $G_{n-1}$ es $2^n$; por otro lado, la
	cantidad de árboles generadores orientados hacia cualquiera de los nodos de
	$G_{n-1}$ es $\frac{2^{2^{n-1}}}{2^n}$ [¿cita?], con lo cual $c_e =
		\frac{2^{2^{n-1}}}{2^n}$ para todo $e$; es decir, $\sum_{e} c_e = 2^{2^{n-1}}$.
	Reemplazando en la expresión anterior, se obtiene \[ 2^{2^{n-1}} \cdot
		\prod_{i=1}^{2^{n-1}} \frac{(d_i\pi_i - 1)! }{(\pi_i!)^{d_i-1}(\pi_i-1)!}.
	\]

	Dado que $G_{n-1}$ es un digrafo regular cuyos vértices tienen todos grado de
	salida $2$, y dado que $\pi_i = m$ para todo $i = 1, \dots, 2^{n-1}$, la
	expresión anterior equivale a
	\begin{align*}
		2^{2^{n-1}} \cdot \left( \frac{(2m - 1)! }{m!(m-1)!} \right)^{2^{n-1}}
			&= \left( \frac{2 (2m - 1)! }{m!(m-1)!} \right)^{2^{n-1}} \\
			&= \left( \frac{2m (2m - 1)! }{m!m(m-1)!} \right)^{2^{n-1}} \\
			&= \left( \frac{(2m)! }{m!m!} \right)^{2^{n-1}} \\
			&= \binom{2m}{m}^{2^{n-1}}.
	\end{align*}

	Resta demostrar el caso en que $n = 1$. Para esto, basta observar que una
	secuencia $(1,m)$-maravillosa es una secuencia de longitud $2m$ en donde
	los símbolos $0$ y $1$ aparecen exactamente $m$ veces cada uno. Por lo tanto,
	construir una de estas secuencias consiste en seleccionar cuáles $m$ de entre
	las $2m$ posiciones contendrán el carácter $0$. La cantidad de formas distintas
	de hacer esto es, por definición, $\binom{2m}{m}$, lo cual es consistente con
	la fórmula presentada. \qed
\end{proof}

\subsection{Secuencias maravillosas anidadas}

\pending{Definir secuencia maravillosa anidada.}

\pending{Definir secuencia perfecta anidada.}

\pending{Definir $m$-átomo.}

\section{Métodos de construcción}

\subsection{Secuencias autosimilares}

En este apartado, presentaremos un método de construcción que permite generar
secuencias $(n,m)$-maravillosas anidadas que no son perfectas anidadas, siempre
y cuando se cumpla que $m = 2^{n - 1}$.
Este método fue motivado por el estudio de una subfamilia de las secuencias
maravillosas anidadas, que denominamos \emph{secuencias autosimilares}.

\begin{definition}
	Una secuencia $x$ es $(n,m)$-\emph{autosimilar} si consiste en $2^{n-1}$
	repeticiones de una misma secuencia de longitud $2m$.
\end{definition}

\begin{example}
	La secuencia \[ 01110110\ 01110110\ 01110110\ 01110110 \] es
	$(3,4)$-autosimilar.
	La secuencia \[ 110000101011 \ 110000101011 \] es $(2,6)$-autosimilar; además,
	es $(2,6)$-maravillosa anidada.
\end{example}

\begin{proposition} \label{proposition:autosimilar-cannot-be-np}
	Una secuencia $(n,m)$-autosimilar con $n > 1$ no puede ser $(n,m)$-perfecta.
\end{proposition}

\begin{proof}
	Dado que la secuencia se construye repitiendo al menos dos veces una misma
	secuencia de longitud $2m$, la palabra de longitud $n$ que aparece en la
	posición $0$ de la secuencia aparece nuevamente en la posición $2m$.
	Esto contradice la definición de secuencia perfecta, ya que cada aparición de
	dicha palabra debería comenzar en una posición distinta módulo $m$.
	\qed
\end{proof}

Nos interesa estudiar las secuencias $(n,m)$-maravillosas anidadas que, además,
son autosimilares.
Cabe señalar que las mismas están conformadas por un único $m$-átomo repetido
$2^{n-1}$ veces.
La proposición que enunciaremos a continuación nos permite caracterizarlas a
partir de una propiedad verificable los átomos que les dan origen.
Este resultado nos permitirá determinar para qué valores de $(n,m)$ existen
este tipo de secuencias, cuál es su cantidad, y presentar un método para su
construcción.

\begin{theorem}
	\label{theorem:autosimilar-nm-characterization}
	Sea $x = \omega^{2^{n-1}}$ una secuencia $(n,m)$-autosimilar.
	$x$ es $(n,m)$-maravillosa anidada si y solo si $2^{n-1} \vert m$ y
	$\omega$
	es una secuencia $\left( n, \frac{m}{2^{n-1}} \right)$-maravillosa.
\end{theorem}

\begin{examples}\ %
	\begin{itemize}
		\item El $4$-átomo $01011100$ es $(1,4)$, $(2,2)$ y
		      $(3,1)$-maravilloso.
		      Por lo tanto, las siguientes tres secuencias son $(1,4)$, $(2,4)$ y
		      $(3,4)$-maravillosas anidadas, respectivamente.
		      \[ 01011100; \qquad 01011100\ 01011100; \qquad 01011100\
			      01011100\ 01011100\ 01011100.
		      \]
		\item El $4$-átomo $10001101$ es $(1,4)$ y $(2,2)$-maravilloso,
		      pero no $(3,1)$-maravilloso.
		      Por lo tanto, las siguientes dos secuencias son $(3,1)$ y $(3,2)$-maravillosas
		      anidadas, respectivamente.
		      \[ 10001101; \qquad 10001101\ 10001101,
		      \]
		      pero la secuencia
		      \[ 10001101\ 10001101\ 10001101\
			      10001101 \]
		      no es $(3,4)$-maravillosa anidada.
	\end{itemize}
\end{examples}

Los siguientes dos lemas se presentan a modo de resultados intermedios para
demostrar el Teorema \ref{theorem:autosimilar-nm-characterization}.

\begin{lema} \label{lemma:marvellous-for-smaller-n}
	Sea $x$ una secuencia $(n,m)$-mavarillosa.
	Para todo $k$ tal que $0 \leq k < n$, la secuencia $x$ es $(n - k,2^{k}
		m)$-maravillosa.
\end{lema}

\begin{example}
	La secuencia $(3,4)$-maravillosa \[ 00001111\ 00101011\ 00101101\ 11100010, \]
	es también $(2,8)$ y $(1,16)$-maravillosa.
\end{example}

\begin{proof}
	Consideremos una palabra $w$ cualquiera de longitud $n - k$.
	Para extender $w$ a una palabra de longitud $n$ debe agregársele un sufijo de
	longitud $k$, por lo que existen $2^{k}$ formas distintas de hacerlo.
	Todas estas palabras que resultan de extender $w$ aparecen exactamente $m$
	veces en $x$, ya que esta es una secuencia $(n,m)$-mavarillosa.
	Luego, $w$ aparece exactamente $2^{k}m$ veces en $x$, $m$ veces como prefijo de
	una palabra de longitud $n$ distinto.
	Por lo tanto, $x$ es una secuencia $(n - k,2^{k}m)$-maravillosa.
	\qed
\end{proof}

Habiendo probado estos dos resultados, estamos en condiciones de presentar una
demostración para el Teorema \ref{theorem:autosimilar-nm-characterization}.

\begin{proof}[Demostración del Teorema \ref{theorem:autosimilar-nm-characterization}]
	Si partimos del supuesto de que $2^{n-1}$ no divide a $m$, o bien que
	$\omega$ no es una secuencia $\left( n, \frac{m}{2^{n-1}}
		\right)$-maravillosa,
	podemos concluir que existe una palabra $w$ de longitud $n$ cuya
	cantidad de
	apariciones en $\omega$, mirada circularmente, es diferente de
	$\frac{m}{2^{n-1}}$.
	Por lo tanto, la cantidad de apariciones de $w$ en $x = \omega^{2^{n-1}}$,
	mirada también circularmente, es diferente de $m$.
	Es decir, en este caso, $x$ no puede ser una secuencia $(n,m)$-maravillosa
	anidada.

	Para demostrar la implicación opuesta, supongamos que $2^{n-1}$ y $\omega$ es
	una secuencia $\left( n, \frac{m}{2^{n-1}} \right)$-maravillosa.
	Demostraremos que para todo $n'$ tal que $1 \leq n' \leq n$, la secuencia
	$\omega^{2^{n'-1}}$ es $(n',m)$-maravillosa anidada.
	En el caso particular $n' = n$, esto equivale a decir que $x$ es una secuencia
	$(n,m)$-maravillosa anidada.

	En el caso $n' = 1$, el resultado se sigue del Lema
	\ref{lemma:marvellous-for-smaller-n} que, tomando $k = n-1$, nos permite
	afirmar que $\omega$ es una secuencia $(1,m)$-maravillosa.

	Si $n'$ es tal que $1 < n' \leq n$, supongamos probado el resultado para
	$n'-1$.
	Esto quiere decir que, siendo $y = \omega^{2^{n' - 2}}$, $y$ es una secuencia
	$(n'-1, m)$-maravillosa anidada.
	Para probar que $\omega^{2^{n' - 1}} = yy$ es $(n',m)$-maravillosa anidada,
	solo resta ver que es $(n',m)$-maravillosa, ya que es la concatenación de dos
	secuencias $(n'-1, m)$-maravillosas anidadas.

	Empleando otra vez el Lema \ref{lemma:marvellous-for-smaller-n}, esta vez para
	$k = n - n'$, tenemos que $\omega$ es una secuencia $\left( n', \frac{m}{2^{n'
				- 1}} \right)$-maravillosas.
	Esto significa que la cantidad de apariciones de cada palabra de longitud $n'$
	en $\omega$, mirada circularmente, es $\frac{m}{2^{n' - 1}}$; y por
	consiguiente, es $m$ en $\omega^{2^{n'-1}}$, por lo que esta última secuencia
	es $(n',m)$-maravillosa anidada.
	\qed
\end{proof}

Dado que conocemos la cantidad de secuencias maravillosas que existen para
cualesquiera valores de $n$ y $m$, podemos enunciar el siguiente corolario.

\begin{corollary} \label{corollary:autosimilar-nm-count}
	Sean $n, m > 0$.
	Si $2^{n-1} \vert m$, sea $k = \frac{m}{2^{n-1}}$; existen
	$\binom{2k}{k}^{2^{n-1}}$ secuencias $(n,m)$-maravillosas anidadas que son
	autosimilares.
	De lo contrario, no existe ninguna tal secuencia.
\end{corollary}

\begin{proof}
	Se sigue de forma inmediata de la caracterización dada por el Teorema
	\ref{theorem:autosimilar-nm-characterization} y la fórmula para la cantidad de
	secuencias maravillosas presentada en el Teorema \ref{theorem:marvellous-count}.
\end{proof}

La siguiente tabla muestra las cantidades de secuencias maravillosas anidadas
autosimilares para los primeros valores de $n$ y $m$.

\begin{table}[H]
	\centering
	\begin{tabular}{ c | c | c | c | c | c | c | c | c | c }
		\diagbox{$n$}{$m$}	& 1 & 2 & 3  & 4  & 5   & 6   & 7    & 8     & 9     \\
		\hline
		1 & 2 & 6 & 20 & 70 & 252 & 924 & 3432 & 12870 & 48620
		\\ \hline
		2 & 0 & 4 & 0  & 36 & 0   & 400 & 0    & 4900  & 0     \\
		\hline
		3 & 0 & 0 & 0  & 16 & 0   & 0   & 0    & 1296  & 0     \\
		\hline
		4 & 0 & 0 & 0  & 0  & 0   & 0   & 0    & 256   & 0     \\
		\hline
		5 & 0 & 0 & 0  & 0  & 0   & 0   & 0    & 0     & 0
	\end{tabular}
	\caption{Cantidad de secuencias $(n,m)$-maravillosas anidadas autosimilares.}
\end{table}

Puede notarse que, debido a la condición de que $2^{n-1} \vert m$ necesaria
para la existencia de este tipo de secuencias, el menor $m$ para el cual la
cantidad de secuencias no es $0$ dado un $n$ fijo es $m = 2^{n-1}$. Este caso
es especialmente interesante ya que los átomos que se utilizarán son secuencias
$(n, 1)$-maravillosas, es decir, secuencias $n$-de De Bruijn.

\note{Creo que acá se podría hacer referencia a métodos existentes para
construir secuencias de De Bruijn y como este método permite adaptarlos
de una forma muy simple para obtener secuencias maravillosas anidadas.}

\bibliography{references}{}
\bibliographystyle{plain}

\end{document}
